import{r as a,i as fe,u as he,j as e,p as U,k as A,q as W,s as ve,B as z}from"./index-B5oqQfuu.js";import{b as _e,c as i,h as xe,d as O,e as je,u as Se,S as Ne,a as Oe}from"./Select-ef7c0426.esm-DLFZ2r57.js";import{T as Ce}from"./Toast-D2SR_lEB.js";import{S as ge}from"./StepIndicator-Cyy8RdIP.js";import{s as be,C as ye}from"./customers-DCnjKzse.js";import{e as Ie,f as G}from"./creditApplicationStorage-CWb-_15N.js";import"./setPrototypeOf-DgZC2w_0.js";import"./floating-ui.dom-2mXtW4pO.js";var Le=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function Pe(n){var u=n.defaultOptions,s=u===void 0?!1:u,l=n.cacheOptions,d=l===void 0?!1:l,p=n.loadOptions;n.options;var x=n.isLoading,C=x===void 0?!1:x,j=n.onInputChange,S=n.filterOption,g=S===void 0?null:S,f=_e(n,Le),t=f.inputValue,c=a.useRef(void 0),o=a.useRef(!1),J=a.useState(Array.isArray(s)?s:void 0),E=i(J,2),K=E[0],V=E[1],Q=a.useState(typeof t<"u"?t:""),R=i(Q,2),k=R[0],b=R[1],X=a.useState(s===!0),F=i(X,2),Y=F[0],h=F[1],Z=a.useState(void 0),$=i(Z,2),y=$[0],I=$[1],ee=a.useState([]),q=i(ee,2),se=q[0],L=q[1],te=a.useState(!1),B=i(te,2),ae=B[0],N=B[1],re=a.useState({}),M=i(re,2),v=M[0],T=M[1],ne=a.useState(void 0),w=i(ne,2),ce=w[0],ie=w[1],oe=a.useState(void 0),H=i(oe,2),ue=H[0],le=H[1];d!==ue&&(T({}),le(d)),s!==ce&&(V(Array.isArray(s)?s:void 0),ie(s)),a.useEffect(function(){return o.current=!0,function(){o.current=!1}},[]);var P=a.useCallback(function(_,m){if(!p)return m();var r=p(_,m);r&&typeof r.then=="function"&&r.then(m,function(){return m()})},[p]);a.useEffect(function(){s===!0&&P(k,function(_){o.current&&(V(_||[]),h(!!c.current))})},[]);var de=a.useCallback(function(_,m){var r=xe(_,m,j);if(!r){c.current=void 0,b(""),I(""),L([]),h(!1),N(!1);return}if(d&&v[r])b(r),I(r),L(v[r]),h(!1),N(!1);else{var pe=c.current={};b(r),h(!0),N(!y),P(r,function(D){o&&pe===c.current&&(c.current=void 0,h(!1),I(r),L(D||[]),N(!1),T(D?O(O({},v),{},je({},r,D)):v))})}},[d,P,y,v,j]),me=ae?[]:k&&y?se:K||[];return O(O({},f),{},{options:me,isLoading:Y||C,onInputChange:de,filterOption:g})}var De=a.forwardRef(function(n,u){var s=Pe(n),l=Se(s);return a.createElement(Ne,Oe({ref:u},l))}),Ae=De;function Me(){var f;const n=fe(),u=he(),[s,l]=a.useState(null),d=(f=n.state)==null?void 0:f.product;a.useEffect(()=>{const t=Ie();t&&l({value:t.id,label:t.fullName,customer:t})},[]);const p=[{label:"Product",description:"Selection"},{label:"Identity",description:"Verification"},{label:"Details",description:"Loan Details"},{label:"Review",description:"Application"}],x=a.useCallback(t=>be(t).then(c=>c.map(o=>({value:o.id,label:o.fullName,customer:o}))),[]),C=t=>{l(t),t!=null&&t.customer?G(t.customer):G(null)},j=({label:t,customer:c})=>c?e.jsxs("div",{className:"customer-option",children:[e.jsx("div",{className:"customer-option__icon",children:e.jsx(U,{})}),e.jsxs("div",{className:"customer-option__content",children:[e.jsx("div",{className:"customer-option__name",children:t}),e.jsxs("div",{className:"customer-option__details",children:[e.jsxs("span",{children:[e.jsx(A,{})," ",c.idNumber]}),e.jsxs("span",{children:[e.jsx(W,{})," ",c.email]})]})]})]}):t,S=()=>{if(!s){Ce.error("Please select a customer");return}u("/credit-request/customer-info",{state:{product:d,customer:s.customer,method:"search"}})},g=()=>{u("/credit-request",{state:{product:d}})};return e.jsxs("div",{className:"customer-search-screen",children:[e.jsxs("div",{className:"customer-search-screen__header",children:[e.jsx("h1",{className:"customer-search-screen__title",children:"Search Customer"}),e.jsx("p",{className:"customer-search-screen__subtitle",children:"Find existing customer by name, ID number, or email"})]}),e.jsxs("div",{className:"customer-search-screen__content",children:[e.jsx(ge,{steps:p,currentStep:2}),e.jsxs("div",{className:"customer-search-screen__main",children:[e.jsxs("div",{className:"customer-search-screen__layout",children:[e.jsxs("div",{className:"customer-search-screen__left",children:[e.jsxs("div",{className:"customer-search-screen__search",children:[e.jsxs("label",{className:"form-label",children:["Search Customer",e.jsx("span",{className:"text-danger",children:" *"})]}),e.jsx(Ae,{cacheOptions:!0,defaultOptions:!0,loadOptions:x,onChange:C,value:s,placeholder:"Type to search (name, ID, or email)...",classNamePrefix:"react-select",formatOptionLabel:j,noOptionsMessage:({inputValue:t})=>t?"No customers found":"Start typing to search...",loadingMessage:()=>"Searching..."}),e.jsx("div",{className:"form-text",children:"Search by customer name, ID number, or email address"})]}),s&&e.jsx("div",{className:"customer-search-screen__selected",children:e.jsxs("div",{className:"selected-customer",children:[e.jsxs("div",{className:"selected-customer__header",children:[e.jsx(U,{className:"selected-customer__icon"}),e.jsx("h3",{className:"selected-customer__name",children:s.customer.fullName})]}),e.jsxs("div",{className:"selected-customer__details",children:[e.jsxs("div",{className:"selected-customer__detail",children:[e.jsx(A,{}),e.jsxs("span",{children:["Personal Number: ",s.customer.personalNumber]})]}),e.jsxs("div",{className:"selected-customer__detail",children:[e.jsx(A,{}),e.jsxs("span",{children:["ID Number: ",s.customer.idNumber]})]}),e.jsxs("div",{className:"selected-customer__detail",children:[e.jsx(W,{}),e.jsx("span",{children:s.customer.email})]}),e.jsxs("div",{className:"selected-customer__detail",children:[e.jsx(ve,{}),e.jsx("span",{children:s.customer.phone})]})]})]})})]}),e.jsx("div",{className:"customer-search-screen__right",children:s&&e.jsx(ye,{customerId:s.customer.id})})]}),e.jsxs("div",{className:"customer-search-screen__actions",children:[e.jsx(z,{label:"Back",onClick:g,variant:"btn-outline"}),e.jsx(z,{label:"Continue",onClick:S,variant:"btn-primary",disabled:!s})]})]})]})]})}export{Me as default};
