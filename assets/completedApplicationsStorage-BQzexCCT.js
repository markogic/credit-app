const s="completed_credit_applications",N=()=>{try{const e=localStorage.getItem(s);return e?JSON.parse(e).map(t=>{var r;return{...t,completedAt:new Date(t.completedAt),creditDecision:{...t.creditDecision,decisionDate:(r=t.creditDecision)!=null&&r.decisionDate?new Date(t.creditDecision.decisionDate):null}}}):[]}catch(e){return console.error("Error reading completed applications:",e),[]}},I=e=>{var o,t,r,i,n,d,l,u,m,a,g,p,S,f;try{const c=N(),A={applicationId:e.applicationId||`APP-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,completedAt:new Date().toISOString(),status:e.status||"completed",product:{id:(o=e.product)==null?void 0:o.id,name:(t=e.product)==null?void 0:t.name,sku:(r=e.product)==null?void 0:r.sku,price:(i=e.product)==null?void 0:i.price,category:(n=e.product)==null?void 0:n.category},customer:{fullName:((d=e.customer)==null?void 0:d.fullName)||((l=e.extractedData)==null?void 0:l.fullName),personalNumber:((u=e.customer)==null?void 0:u.personalNumber)||((m=e.extractedData)==null?void 0:m.personalNumber),idNumber:((a=e.customer)==null?void 0:a.idNumber)||((g=e.extractedData)==null?void 0:g.idNumber),dateOfBirth:((p=e.customer)==null?void 0:p.dateOfBirth)||((S=e.extractedData)==null?void 0:S.dateOfBirth)},creditDecision:{...e.creditDecision,decisionDate:(f=e.creditDecision)!=null&&f.decisionDate?new Date(e.creditDecision.decisionDate).toISOString():new Date().toISOString()},hasSignature:!!e.signature};c.unshift(A);const h=c.slice(0,100);return localStorage.setItem(s,JSON.stringify(h)),console.log("âœ“ Application saved to history"),A}catch(c){throw console.error("Error saving completed application:",c),c}},y=e=>{try{const t=N().filter(r=>r.applicationId!==e);return localStorage.setItem(s,JSON.stringify(t)),!0}catch(o){return console.error("Error deleting application:",o),!1}};export{y as d,N as g,I as s};
